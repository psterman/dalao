# 统一收藏管理系统测试指南

## 📋 测试范围

### 1. 核心数据层测试

#### 1.1 数据模型测试
- [ ] 创建`UnifiedCollectionItem`实例
- [ ] 验证11个元数据字段
- [ ] 验证9种收藏类型
- [ ] 验证时间格式化方法
- [ ] 验证来源显示文本方法

#### 1.2 管理器测试
- [ ] 添加收藏项
- [ ] 更新收藏项
- [ ] 删除收藏项
- [ ] 批量删除
- [ ] 移动收藏项到其他类型
- [ ] 批量移动
- [ ] 搜索功能（文本、类型、标签、时间、优先级、状态、加密）
- [ ] 排序功能（7种排序维度）
- [ ] 导入JSON
- [ ] 导出JSON
- [ ] 导出CSV

### 2. UI组件测试

#### 2.1 适配器测试
- [ ] 列表视图模式显示
- [ ] 网格视图模式显示
- [ ] 时间线视图模式显示
- [ ] 批量选择功能
- [ ] 长按进入选择模式
- [ ] 全选/取消全选
- [ ] 时间线自动分组

#### 2.2 编辑面板测试
- [ ] 打开编辑面板
- [ ] 编辑所有11个字段
- [ ] 添加/删除标签
- [ ] 选择优先级
- [ ] 选择完成状态
- [ ] 设置喜欢程度（星级）
- [ ] 选择情感标签
- [ ] 设置加密状态
- [ ] 设置提醒时间
- [ ] 保存修改

#### 2.3 搜索面板测试
- [ ] 打开搜索面板
- [ ] 文本搜索
- [ ] 标签搜索
- [ ] 类型筛选
- [ ] 时间范围筛选（今天/7天/30天/3个月/自定义）
- [ ] 优先级筛选
- [ ] 完成状态筛选
- [ ] 加密状态筛选
- [ ] 重置搜索条件

### 3. Fragment集成测试

#### 3.1 标签分类测试
- [ ] 显示所有标签（Prompt分类 + 统一收藏类型）
- [ ] 点击标签切换内容
- [ ] 标签拖拽排序
- [ ] 搜索历史合并显示

#### 3.2 统一收藏列表测试
- [ ] 显示AI回复收藏
- [ ] 显示搜索历史（标记来源）
- [ ] 显示网页收藏
- [ ] 显示电子书收藏
- [ ] 显示图片收藏
- [ ] 显示视频收藏
- [ ] 显示读书划线
- [ ] 显示剪贴板历史

#### 3.3 视图模式切换测试
- [ ] 切换到列表模式
- [ ] 切换到网格模式
- [ ] 切换到时间线模式
- [ ] 布局管理器正确切换

#### 3.4 筛选和排序测试
- [ ] 打开筛选对话框
- [ ] 选择排序维度
- [ ] 选择排序方向
- [ ] 应用排序
- [ ] 清除排序

#### 3.5 批量操作测试
- [ ] 进入批量选择模式
- [ ] 选择多个收藏项
- [ ] 批量删除
- [ ] 批量移动
- [ ] 批量编辑（单个）
- [ ] 全选/取消全选
- [ ] 退出批量选择模式

#### 3.6 导入导出测试
- [ ] 导出为JSON
- [ ] 导出为CSV
- [ ] 从JSON导入
- [ ] 导入后数据正确显示

## 🧪 测试步骤

### 步骤1：测试数据模型

```kotlin
// 创建测试收藏项
val testItem = UnifiedCollectionItem(
    title = "测试标题",
    content = "测试内容",
    collectionType = CollectionType.AI_REPLY,
    sourceLocation = "AI对话Tab",
    sourceDetail = "DeepSeek对话",
    customTags = listOf("测试", "AI"),
    priority = Priority.HIGH,
    completionStatus = CompletionStatus.IN_PROGRESS,
    likeLevel = 4,
    emotionTag = EmotionTag.POSITIVE,
    isEncrypted = false,
    reminderTime = System.currentTimeMillis() + 24 * 60 * 60 * 1000
)

// 验证字段
assert(testItem.title == "测试标题")
assert(testItem.collectionType == CollectionType.AI_REPLY)
assert(testItem.customTags.size == 2)
```

### 步骤2：测试管理器

```kotlin
val manager = UnifiedCollectionManager.getInstance(context)

// 添加收藏项
manager.addCollection(testItem)

// 搜索
val results = manager.searchCollections(
    query = "测试",
    type = CollectionType.AI_REPLY,
    priority = Priority.HIGH
)

// 排序
val sorted = manager.sortCollections(
    results,
    SortDimension.COLLECTED_TIME,
    SortDirection.DESC
)

// 导出
val json = manager.exportToJson()
```

### 步骤3：测试UI组件

1. **打开AI助手Tab → 任务场景**
2. **点击左侧标签**（如"AI回复收藏"）
3. **验证右侧显示对应类型的收藏项**
4. **点击收藏项**，验证编辑面板打开
5. **修改字段并保存**，验证数据更新
6. **点击搜索按钮**，验证搜索面板打开
7. **输入搜索条件并搜索**，验证结果正确
8. **长按收藏项**，验证进入批量选择模式
9. **选择多个项**，验证批量操作菜单
10. **切换视图模式**，验证布局切换

## 🐛 已知问题和注意事项

1. **布局文件**：部分布局文件可能需要根据实际UI调整
2. **数据迁移**：数据迁移功能待实现
3. **批量编辑**：批量编辑功能目前只支持单个编辑
4. **文件导入**：JSON导入目前使用输入框，后续应改为文件选择器
5. **CSV导入**：CSV导入功能待完善

## ✅ 测试检查清单

- [ ] 所有数据模型字段正确
- [ ] 管理器CRUD功能正常
- [ ] 搜索功能正常
- [ ] 排序功能正常
- [ ] 适配器三种视图模式正常
- [ ] 编辑面板所有字段可编辑
- [ ] 搜索面板所有筛选条件可用
- [ ] Fragment集成正常
- [ ] 批量操作正常
- [ ] 导入导出正常

---

测试完成后，请记录测试结果和发现的问题。


