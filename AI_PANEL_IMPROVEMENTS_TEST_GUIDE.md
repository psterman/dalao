# AI助手面板功能改进测试指南

## 功能概述
本次更新对灵动岛AI助手面板进行了全面改进，包括：
1. AI服务选择过滤功能
2. 流式显示和滚动条支持
3. AI配置按钮化
4. 真实API调用
5. 输入框高度增加和功能按钮嵌入

## 测试步骤

### 1. 基础功能测试

#### 1.1 打开AI助手面板
1. 启动应用，确保灵动岛服务正在运行
2. 点击灵动岛上的AI助手按钮
3. 验证AI助手面板正常展开显示

#### 1.2 验证UI布局改进
1. 检查输入框高度是否增加到3-5行
2. 验证功能按钮（助手、身份、切换AI）是否嵌入到输入框上方
3. 确认AI配置已改为按钮形式
4. 检查AI回复区域是否支持垂直滚动

### 2. AI服务选择过滤测试

#### 2.1 多选AI服务
1. 在AI配置区域选择多个AI服务（如DeepSeek、Kimi、智谱AI）
2. 输入测试问题："请介绍一下人工智能的发展历史"
3. 点击发送按钮
4. 验证只有选中的AI服务才回复，未选中的不回复

#### 2.2 单选AI服务
1. 只选择一个AI服务（如DeepSeek）
2. 输入测试问题："什么是机器学习？"
3. 点击发送按钮
4. 验证只有选中的AI服务回复

#### 2.3 无选择状态
1. 清空所有AI服务选择
2. 输入测试问题
3. 点击发送按钮
4. 验证显示"请先选择AI服务"提示

### 3. 流式显示和滚动条测试

#### 3.1 流式显示测试
1. 选择一个AI服务
2. 输入较长的问题："请详细解释深度学习的原理和应用"
3. 点击发送按钮
4. 观察AI回复是否逐字显示（流式效果）
5. 验证回复内容支持滚动查看

#### 3.2 Markdown样式测试
1. 输入包含markdown格式的问题
2. 观察AI回复是否正确处理：
   - 粗体文本（**text**）
   - 斜体文本（*text*）
   - 代码块（```code```）
   - 列表项（• 或 1.）

#### 3.3 表情符号过滤测试
1. 输入可能包含表情符号的问题
2. 验证AI回复中的表情符号是否被正确过滤

### 4. 功能按钮测试

#### 4.1 助手按钮
1. 点击"助手"按钮
2. 验证输入框是否加载了助手prompt
3. 验证prompt内容是否合适

#### 4.2 身份按钮
1. 点击"身份"按钮
2. 验证输入框是否加载了身份prompt
3. 验证prompt内容是否合适

#### 4.3 切换AI按钮
1. 点击"切换AI"按钮
2. 验证AI服务选择是否发生变化
3. 验证状态显示是否正确更新

### 5. AI配置按钮测试

#### 5.1 配置页面跳转
1. 点击"AI配置"按钮
2. 验证是否跳转到设置页面的AI配置部分
3. 验证配置页面功能是否正常

#### 5.2 配置保存返回
1. 在AI配置页面修改API密钥
2. 保存配置
3. 返回AI助手面板
4. 验证配置是否生效

### 6. 真实API调用测试

#### 6.1 API连接测试
1. 确保已正确配置API密钥
2. 选择不同的AI服务进行测试
3. 验证每个AI服务都能正常连接和回复

#### 6.2 错误处理测试
1. 故意输入错误的API密钥
2. 测试网络断开情况
3. 验证错误信息是否正确显示

### 7. 性能测试

#### 7.1 多AI并发测试
1. 同时选择3-5个AI服务
2. 发送复杂问题
3. 验证所有AI服务是否都能正常回复
4. 观察内存使用情况

#### 7.2 长时间使用测试
1. 连续使用AI助手面板30分钟
2. 发送多个问题
3. 验证系统稳定性

## 预期结果

### 成功标准
1. ✅ 只有选中的AI服务才回复
2. ✅ AI回复支持流式显示和滚动查看
3. ✅ AI配置按钮能正确跳转
4. ✅ 功能按钮能正确加载prompt
5. ✅ 输入框高度增加，布局更合理
6. ✅ 所有API调用都是真实的，无硬编码模板
7. ✅ Markdown样式正确处理
8. ✅ 表情符号正确过滤

### 注意事项
1. 确保网络连接正常
2. 确保API密钥配置正确
3. 测试时注意观察日志输出
4. 如发现问题，请记录具体的错误信息

## 故障排除

### 常见问题
1. **AI服务无回复**：检查API密钥配置
2. **流式显示不工作**：检查网络连接
3. **按钮点击无响应**：检查UI绑定
4. **滚动条不显示**：检查布局高度设置

### 调试方法
1. 查看Logcat日志
2. 检查网络请求状态
3. 验证UI元素绑定
4. 测试API连接性

## 测试完成确认
- [ ] 所有基础功能正常
- [ ] AI服务选择过滤正常
- [ ] 流式显示和滚动正常
- [ ] 功能按钮正常工作
- [ ] AI配置跳转正常
- [ ] 真实API调用正常
- [ ] 性能表现良好
- [ ] 无崩溃或异常

测试完成后，请在此文档中记录测试结果和发现的问题。
