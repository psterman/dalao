# 应用跳转逻辑分析报告

## 一、视频类应用

### 1. 优酷
- **包名**: `com.youku.phone`
- **URL Scheme**: `youku://`
- **搜索跳转URL**: `youku://search?keyword={query}`
- **特点**: 使用`keyword`参数，参数名与其他视频应用一致

### 2. 爱奇艺
- **包名**: `com.iqiyi.app` 或 `com.iqiyi.hd`
- **URL Scheme**: `iqiyi://`
- **搜索跳转URL**: `iqiyi://search?key={query}`
- **特点**: 使用`key`参数（注意不是`keyword`），与其他视频应用不同

### 3. 腾讯视频
- **包名**: `com.tencent.qqlive`
- **URL Scheme**: `qqlive://`
- **搜索跳转URL**: `qqlive://search?query={query}`
- **特点**: 使用`query`参数，参数名与其他视频应用不同

### 4. 哔哩哔哩
- **包名**: `tv.danmaku.bili`
- **URL Scheme**: `bilibili://`
- **搜索跳转URL**: `bilibili://search?keyword={query}`
- **特点**: 使用`keyword`参数，与优酷、快手一致

### 5. 快手
- **包名**: `com.smile.gifmaker`
- **URL Scheme**: `kuaishou://` 或 `kwai://`
- **搜索跳转URL**: 
  - DynamicIslandService: `kuaishou://search?keyword={query}`
  - PlatformJumpManager: `kwai://search?keyword={query}`
- **特点**: 存在两种URL scheme，代码中使用了不同的scheme

### 6. 抖音
- **包名**: `com.ss.android.ugc.aweme`
- **URL Scheme**: `snssdk1128://`
- **搜索跳转URL**: `snssdk1128://search/tabs?keyword={query}`
- **特点**: 
  - 使用特殊的URL scheme（不是应用名）
  - 路径为`/search/tabs`，与其他应用不同
  - 使用`keyword`参数

## 二、购物类应用

### 1. 拼多多
- **包名**: `com.xunmeng.pinduoduo`
- **URL Scheme**: `pinduoduo://`
- **搜索跳转URL**: `pinduoduo://com.xunmeng.pinduoduo/search_result.html?search_key={query}`
- **特点**: 
  - URL中包含完整包名路径
  - 使用`search_key`参数
  - 路径为`/search_result.html`

### 2. 京东
- **包名**: `com.jingdong.app.mall`
- **URL Scheme**: `openapp.jdmobile://`
- **搜索跳转URL**: `openapp.jdmobile://virtual?params={"des":"productList","keyWord":"{query}"}`
- **特点**: 
  - 使用JSON格式的`params`参数
  - 参数中包含`des`（描述）和`keyWord`（关键词）
  - 需要URL编码整个JSON字符串

### 3. 闲鱼
- **包名**: `com.taobao.idlefish`
- **URL Scheme**: `fleamarket://`
- **搜索跳转URL**: `fleamarket://x_search_items?keyword={query}`
- **特点**: 
  - 使用`fleamarket`作为scheme（不是应用名）
  - 路径为`/x_search_items`
  - 使用`keyword`参数

### 4. 天猫
- **包名**: `com.tmall.wireless`
- **URL Scheme**: `tmall://`
- **搜索跳转URL**: `tmall://page.tm/search?q={query}`
- **特点**: 
  - 路径为`/page.tm/search`
  - 使用`q`参数（短参数名）

### 5. 淘宝
- **包名**: `com.taobao.taobao`
- **URL Scheme**: `taobao://`
- **搜索跳转URL**: `taobao://s.taobao.com?q={query}`
- **特点**: 
  - URL中包含域名`s.taobao.com`
  - 使用`q`参数（短参数名）
  - 与天猫类似但路径不同

## 三、社交类应用

### 1. 知乎
- **包名**: `com.zhihu.android`
- **URL Scheme**: `zhihu://`
- **搜索跳转URL**: `zhihu://search?q={query}`
- **特点**: 
  - 使用`q`参数（短参数名）
  - 路径为`/search`

### 2. 微博轻享
- **包名**: `com.sina.weibo.lite`
- **URL Scheme**: `sinaweibo://`
- **搜索跳转URL**: `sinaweibo://searchall?q={query}`
- **特点**: 
  - 与微博使用相同的URL scheme
  - 路径为`/searchall`
  - 使用`q`参数

### 3. 微博
- **包名**: `com.sina.weibo`
- **URL Scheme**: `sinaweibo://`
- **搜索跳转URL**: `sinaweibo://searchall?q={query}`
- **特点**: 
  - 与微博轻享使用相同的URL scheme和路径
  - 使用`q`参数

### 4. 豆瓣
- **包名**: `com.douban.frodo`
- **URL Scheme**: `douban://`
- **搜索跳转URL**: `douban://search?q={query}` 或 `douban:///search?q={query}`
- **特点**: 
  - 注意路径可能是`/search`或`//search`（三个斜杠）
  - 使用`q`参数

### 5. 小红书
- **包名**: `com.xingin.xhs`
- **URL Scheme**: `xhsdiscover://`
- **搜索跳转URL**: `xhsdiscover://search/result?keyword={query}`
- **特点**: 
  - 使用`xhsdiscover`作为scheme（不是应用名）
  - 路径为`/search/result`
  - 使用`keyword`参数

## 四、生活服务类应用

### 1. 美团
- **包名**: `com.sankuai.meituan`
- **URL Scheme**: `imeituan://`
- **搜索跳转URL**: `imeituan://www.meituan.com/search?q={query}`
- **特点**: 
  - URL中包含域名`www.meituan.com`
  - 使用`q`参数

### 2. 饿了么
- **包名**: `me.ele`
- **URL Scheme**: `eleme://`
- **搜索跳转URL**: `eleme://search?keyword={query}`
- **特点**: 
  - 使用`keyword`参数
  - 路径为`/search`

### 3. 大众点评
- **包名**: `com.dianping.v1`
- **URL Scheme**: `dianping://`
- **搜索跳转URL**: `dianping://searchshoplist?keyword={query}`
- **特点**: 
  - 路径为`/searchshoplist`（搜索店铺列表）
  - 使用`keyword`参数

## 五、浏览器类应用

### 1. UC浏览器
- **包名**: `com.UCMobile`
- **URL Scheme**: `ucbrowser://`
- **搜索跳转URL**: `ucbrowser://search?keyword={query}`
- **特点**: 
  - 使用`keyword`参数
  - 路径为`/search`

### 2. QQ浏览器
- **包名**: `com.tencent.mtt`
- **URL Scheme**: `mttbrowser://`
- **搜索跳转URL**: `mttbrowser://search?query={query}`
- **特点**: 
  - 使用`mttbrowser`作为scheme（不是应用名）
  - 使用`query`参数（不是`keyword`）

### 3. 夸克
- **包名**: `com.quark.browser`
- **URL Scheme**: `quark://`
- **搜索跳转URL**: `quark://search?q={query}`
- **特点**: 
  - 使用`q`参数（短参数名）
  - 路径为`/search`

## 六、音乐类应用

### 1. QQ音乐
- **包名**: `com.tencent.qqmusic`
- **URL Scheme**: `qqmusic://`
- **搜索跳转URL**: `qqmusic://search?key={query}`
- **特点**: 
  - 使用`key`参数（注意不是`keyword`或`query`）
  - 与爱奇艺使用相同的参数名

### 2. 网易云音乐
- **包名**: `com.netease.cloudmusic`
- **URL Scheme**: `orpheus://`
- **搜索跳转URL**: `orpheus://search?keyword={query}`
- **特点**: 
  - 使用`orpheus`作为scheme（不是应用名）
  - 使用`keyword`参数

## 七、地图导航类应用

### 1. 高德地图
- **包名**: `com.autonavi.minimap`
- **URL Scheme**: `androidamap://`
- **搜索跳转URL**: `androidamap://poi?sourceApplication=appname&keywords={query}`
- **特点**: 
  - 使用`androidamap`作为scheme（不是应用名）
  - 路径为`/poi`（兴趣点）
  - 包含`sourceApplication`参数
  - 使用`keywords`参数（复数形式）

### 2. 腾讯地图
- **包名**: `com.tencent.map`
- **URL Scheme**: `tencentmap://`
- **搜索跳转URL**: `tencentmap://map/place/search?query={query}`
- **特点**: 
  - 路径为`/map/place/search`
  - 使用`query`参数

### 3. 百度地图
- **包名**: `com.baidu.BaiduMap`
- **URL Scheme**: `baidumap://`
- **搜索跳转URL**: `baidumap://map/place/search?query={query}`
- **特点**: 
  - 路径为`/map/place/search`（与腾讯地图相同）
  - 使用`query`参数

## 八、跳转逻辑总结

### 参数命名差异
1. **使用`keyword`参数**: 优酷、哔哩哔哩、快手、小红书、饿了么、大众点评、UC浏览器、网易云音乐
2. **使用`key`参数**: 爱奇艺、QQ音乐
3. **使用`query`参数**: 腾讯视频、QQ浏览器、腾讯地图、百度地图
4. **使用`q`参数**: 知乎、微博、微博轻享、豆瓣、天猫、淘宝、美团、夸克

### URL Scheme命名差异
1. **使用应用名作为scheme**: 优酷、爱奇艺、腾讯视频、哔哩哔哩、知乎、天猫、淘宝、美团、饿了么、大众点评、夸克、QQ音乐
2. **使用特殊scheme**: 
   - 抖音: `snssdk1128://`
   - 快手: `kuaishou://` 或 `kwai://`
   - 小红书: `xhsdiscover://`
   - 闲鱼: `fleamarket://`
   - 京东: `openapp.jdmobile://`
   - 网易云音乐: `orpheus://`
   - 高德地图: `androidamap://`
   - QQ浏览器: `mttbrowser://`

### 路径结构差异
1. **简单路径**: `/search` - 大多数应用
2. **复杂路径**: 
   - 抖音: `/search/tabs`
   - 小红书: `/search/result`
   - 拼多多: `/com.xunmeng.pinduoduo/search_result.html`
   - 闲鱼: `/x_search_items`
   - 天猫: `/page.tm/search`
   - 淘宝: `s.taobao.com`（域名形式）
   - 大众点评: `/searchshoplist`
   - 腾讯地图/百度地图: `/map/place/search`
   - 高德地图: `/poi`

### 特殊格式
1. **JSON格式参数**: 京东使用JSON格式的`params`参数
2. **域名形式**: 淘宝、美团在URL中包含域名
3. **三个斜杠**: 豆瓣可能使用`douban:///search`（三个斜杠）

## 九、代码实现位置

### 主要实现文件
1. **DynamicIslandService.kt** (行4000-4100, 9600-9800)
   - `launchAppSearchResults()` 方法
   - `handleSearchWithSelectedApp()` 方法
   - 包含所有应用的URL scheme映射

2. **PlatformJumpManager.kt** (行560-615)
   - `jumpToApp()` 方法
   - 主要处理预设平台的跳转

3. **AppSearchSettings.kt** (行250-600)
   - 定义所有应用的配置信息
   - 包含包名、URL scheme、搜索URL等

### 包名映射
在 `DynamicIslandService.kt` 的 `getUrlSchemeApps()` 方法中（行3900-3950）定义了包名到URL scheme的映射关系。

## 十、注意事项

1. **快手存在两种URL scheme**: 代码中同时使用了`kuaishou://`和`kwai://`，需要统一
2. **京东需要JSON编码**: 参数是JSON格式，需要正确编码
3. **豆瓣路径特殊**: 可能使用三个斜杠`//search`
4. **微博轻享与微博相同**: 使用相同的URL scheme，无法区分
5. **参数名不统一**: 不同应用使用不同的参数名（keyword/key/query/q），需要分别处理




