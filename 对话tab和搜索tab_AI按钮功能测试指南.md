# 对话tab和搜索tab AI按钮功能测试指南

## 功能概述

1. **对话tab AI按钮** - 在对话tab的搜索框右侧添加了AI按钮，点击后弹出AI助手档案选择器
2. **搜索tab AI按钮** - 搜索tab的AI按钮功能已改造，实现与对话tab相同的功能

## 实现内容

### 1. 对话tab AI按钮
- **布局文件**: `app/src/main/res/layout/activity_simple_mode.xml`
- **按钮ID**: `chat_ai_assistant_button`
- **位置**: 对话tab搜索框右侧，添加联系人按钮左侧
- **样式**: 36dp圆形按钮，使用AI助手图标，主题色

### 2. 搜索tab AI按钮
- **布局文件**: `app/src/main/res/layout/layout_app_search.xml`
- **按钮ID**: `ai_assistant_button`
- **位置**: 搜索输入框右侧
- **样式**: 48dp圆形按钮，使用AI助手图标，主题色

### 3. 功能实现
- **对话tab方法**: `showChatTabAIProfileSelector()`
- **搜索tab方法**: `showSearchTabAIProfileSelector()`
- **共同功能**:
  - 显示AI助手档案选择对话框
  - 支持档案切换
  - 自动生成并插入提示词到对应输入框
  - 支持追加模式和替换模式

### 4. 主题适配
- **对话tab**: `updateChatPageColors()` 方法中添加AI按钮颜色更新
- **搜索tab**: `updateInputAndButtonColors()` 方法中添加AI按钮颜色更新
- **颜色**: 使用各自tab的主题色

## 测试步骤

### 测试1：对话tab AI按钮显示
1. 打开应用，进入简易模式
2. 切换到对话tab（第一个tab）
3. **预期结果**: 在搜索框右侧看到AI助手按钮（机器人图标）

### 测试2：对话tab AI按钮功能
1. 在对话tab中点击AI助手按钮
2. **预期结果**: 弹出AI助手档案选择对话框

### 测试3：对话tab档案选择功能
1. 点击对话tab的AI助手按钮
2. 在对话框中选择一个档案
3. 点击确认按钮
4. **预期结果**: 
   - 对话框关闭
   - 对话搜索输入框中出现生成的提示词
   - 显示"已切换到档案: [档案名] 并生成提示词"的提示

### 测试4：搜索tab AI按钮功能
1. 切换到搜索tab（第二个tab）
2. 点击搜索输入框右侧的AI助手按钮
3. **预期结果**: 弹出AI助手档案选择对话框

### 测试5：搜索tab档案选择功能
1. 点击搜索tab的AI助手按钮
2. 选择一个档案并确认
3. **预期结果**: 
   - 对话框关闭
   - 搜索输入框中出现生成的提示词
   - 显示"已切换到档案: [档案名] 并生成提示词"的提示

### 测试6：提示词追加功能（对话tab）
1. 在对话tab搜索输入框中输入一些文字
2. 点击AI助手按钮
3. 选择一个档案并确认
4. **预期结果**: 新生成的提示词追加到现有文字后面，用换行符分隔

### 测试7：提示词追加功能（搜索tab）
1. 在搜索tab输入框中输入一些文字
2. 点击AI助手按钮
3. 选择一个档案并确认
4. **预期结果**: 新生成的提示词追加到现有文字后面，用换行符分隔

### 测试8：提示词替换功能（对话tab）
1. 清空对话tab搜索输入框
2. 点击AI助手按钮
3. 选择一个档案并确认
4. **预期结果**: 搜索输入框中只显示新生成的提示词

### 测试9：提示词替换功能（搜索tab）
1. 清空搜索tab输入框
2. 点击AI助手按钮
3. 选择一个档案并确认
4. **预期结果**: 搜索输入框中只显示新生成的提示词

### 测试10：主题适配
1. 在设置中切换主题（亮色/暗色）
2. 分别检查对话tab和搜索tab
3. **预期结果**: 两个tab的AI按钮颜色都随主题变化

### 测试11：无档案情况
1. 确保没有创建任何AI助手档案
2. 分别点击对话tab和搜索tab的AI助手按钮
3. **预期结果**: 都显示"没有可用的档案，请先在设置中创建档案"的提示

## 验证要点

1. **按钮显示**: 两个tab的AI按钮都正确显示在对应位置
2. **点击响应**: 点击按钮能正确弹出档案选择对话框
3. **档案选择**: 能正确选择档案并生成提示词
4. **文本插入**: 提示词正确插入到对应的输入框
5. **追加模式**: 有现有文本时能正确追加
6. **替换模式**: 无现有文本时能正确替换
7. **主题适配**: 按钮颜色随主题变化
8. **错误处理**: 无档案时显示友好提示
9. **功能一致**: 两个tab的AI按钮功能完全一致

## 注意事项

- 确保已创建AI助手档案才能测试完整功能
- 档案选择对话框使用现有的`dialog_profile_selector`布局
- 提示词生成使用`settingsManager.generateMasterPrompt()`方法
- 按钮颜色使用各自tab的主题色，确保在不同主题下都清晰可见
- 两个tab的AI按钮功能完全一致，提供统一的用户体验
