# åº”ç”¨å›¾æ ‡è‡ªåŠ¨ç²˜è´´æ–¹æ¡ˆè¯´æ˜

## ğŸ¯ æ–¹æ¡ˆæ¦‚è¿°

æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œæˆ‘å·²ç»ä¿®æ”¹äº†çµåŠ¨å²›å±•å¼€ååº”ç”¨å›¾æ ‡çš„ç‚¹å‡»é€»è¾‘ï¼Œå®ç°äº†è‡ªåŠ¨ç²˜è´´è·å–å‰ªè´´æ¿æ•°æ®ï¼Œç„¶åæ„å»ºURL schemeè·³è½¬åˆ°åº”ç”¨æœç´¢ç»“æœé¡µé¢çš„åŠŸèƒ½ã€‚

## ğŸš¨ æ ¸å¿ƒæ”¹è¿›

### åŸæœ‰é€»è¾‘é—®é¢˜
- ä½¿ç”¨å±•å¼€æ—¶çš„å‰ªè´´æ¿å†…å®¹ï¼ˆå¯èƒ½æ˜¯æ—§æ•°æ®ï¼‰
- æ— æ³•è·å–ç”¨æˆ·æœ€æ–°å¤åˆ¶çš„å†…å®¹
- æœç´¢ç»“æœå¯èƒ½ä¸å‡†ç¡®

### æ–°é€»è¾‘ä¼˜åŠ¿
- **å®æ—¶è·å–**ï¼šç‚¹å‡»åº”ç”¨å›¾æ ‡æ—¶è‡ªåŠ¨ç²˜è´´è·å–æœ€æ–°å‰ªè´´æ¿å†…å®¹
- **å‡†ç¡®æœç´¢**ï¼šä½¿ç”¨æœ€æ–°æ•°æ®æ„å»ºURL schemeæœç´¢
- **æ— æ„Ÿæ“ä½œ**ï¼šç”¨æˆ·æ— éœ€æ‰‹åŠ¨æ“ä½œï¼Œè‡ªåŠ¨å®Œæˆæ•´ä¸ªæµç¨‹

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. æ ¸å¿ƒæ–¹æ³•ï¼š`getClipboardContentByAutoPaste()`

```kotlin
// åˆ›å»ºéšè—çš„EditTextç”¨äºæ¥æ”¶ç²˜è´´å†…å®¹
val hiddenEditText = EditText(this).apply {
    layoutParams = ViewGroup.LayoutParams(1, 1)
    alpha = 0f // å®Œå…¨é€æ˜
    isFocusable = true
    isFocusableInTouchMode = true
}

// æ·»åŠ åˆ°çª—å£ç®¡ç†å™¨ï¼ˆéšè—åœ¨å±å¹•å¤–ï¼‰
val windowManager = getSystemService(Context.WINDOW_SERVICE) as WindowManager
windowManager.addView(hiddenEditText, params)

// æ‰§è¡Œè‡ªåŠ¨ç²˜è´´æ“ä½œ
val pastedContent = performAutoPasteOperation(hiddenEditText)
```

### 2. è‡ªåŠ¨ç²˜è´´æ“ä½œï¼š`performAutoPasteOperation()`

```kotlin
// æ–¹æ³•1ï¼šé€šè¿‡InputConnectionæ¨¡æ‹Ÿç²˜è´´
val inputConnection = editText.onCreateInputConnection(EditorInfo())
val pasteResult = inputConnection.performContextMenuAction(android.R.id.paste)

// æ–¹æ³•2ï¼šé€šè¿‡ClipboardManagerç›´æ¥è·å–ï¼ˆå¤‡é€‰ï¼‰
val clipboardManager = getSystemService(Context.CLIPBOARD_SERVICE) as ClipboardManager
if (clipboardManager.hasPrimaryClip()) {
    val content = clipboardManager.primaryClip?.getItemAt(0)?.text?.toString()
}
```

## ğŸ¯ å·¥ä½œæµç¨‹

### åº”ç”¨å›¾æ ‡ç‚¹å‡»æµç¨‹

1. **ç”¨æˆ·ç‚¹å‡»åº”ç”¨å›¾æ ‡**
2. **è‡ªåŠ¨ç²˜è´´è·å–æœ€æ–°å‰ªè´´æ¿å†…å®¹**ï¼š
   - åˆ›å»ºéšè—çš„é€æ˜EditTextï¼ˆåœ¨å±å¹•å¤–ï¼‰
   - æ¨¡æ‹Ÿç²˜è´´æ“ä½œè·å–å‰ªè´´æ¿å†…å®¹
   - æ¸…ç†éšè—è§†å›¾
3. **ç¡®å®šæœç´¢å†…å®¹**ï¼š
   - ä¼˜å…ˆä½¿ç”¨è‡ªåŠ¨ç²˜è´´è·å–çš„æœ€æ–°å†…å®¹
   - å¤‡é€‰ä½¿ç”¨å±•å¼€æ—¶çš„å‰ªè´´æ¿å†…å®¹
   - æœ€åä½¿ç”¨é»˜è®¤æœç´¢å†…å®¹
4. **æ„å»ºURL schemeæœç´¢**ï¼š
   - æ ¹æ®åº”ç”¨ç±»å‹æ„å»ºå¯¹åº”çš„URL scheme
   - ç¼–ç æœç´¢å†…å®¹
5. **è·³è½¬åˆ°åº”ç”¨æœç´¢ç»“æœé¡µé¢**

### å†…å®¹ä¼˜å…ˆçº§

```kotlin
val finalContent = when {
    !latestClipboardContent.isNullOrEmpty() -> {
        // ä¼˜å…ˆï¼šè‡ªåŠ¨ç²˜è´´è·å–çš„æœ€æ–°å†…å®¹
        latestClipboardContent
    }
    !clipboardContent.isNullOrEmpty() -> {
        // å¤‡é€‰ï¼šå±•å¼€æ—¶çš„å‰ªè´´æ¿å†…å®¹
        clipboardContent
    }
    else -> {
        // é»˜è®¤ï¼šé€šç”¨æœç´¢å†…å®¹
        "æœç´¢å†…å®¹"
    }
}
```

## ğŸš€ æ”¯æŒçš„åº”ç”¨ç±»å‹

### ç¤¾äº¤ç±»
- **å¾®ä¿¡** - `weixin://dl/search?query={content}`
- **QQ** - `mqqapi://search?query={content}`
- **ä¼ä¸šå¾®ä¿¡** - `wework://search?query={content}`
- **æ–°æµªå¾®åš** - `sinaweibo://searchall?q={content}`
- **å°çº¢ä¹¦** - `xhsdiscover://search/result?keyword={content}`

### è´­ç‰©ç±»
- **æ·˜å®** - `taobao://s.taobao.com?q={content}`
- **å¤©çŒ«** - `tmall://page.tm/search?q={content}`
- **äº¬ä¸œ** - `openapp.jdmobile://virtual?params={"category":"jump","des":"search","keyword":"{content}"}`
- **æ‹¼å¤šå¤š** - `pinduoduo://com.xunmeng.pinduoduo/search_result.html?search_key={content}`

### è§†é¢‘ç±»
- **æŠ–éŸ³** - `snssdk1128://search?keyword={content}`
- **å¿«æ‰‹** - `kwai://search?keyword={content}`
- **å“”å“©å“”å“©** - `bilibili://search?keyword={content}`
- **è…¾è®¯è§†é¢‘** - `tenvideo2://search?keyword={content}`

### éŸ³ä¹ç±»
- **QQéŸ³ä¹** - `qqmusic://search?key={content}`
- **ç½‘æ˜“äº‘éŸ³ä¹** - `orpheus://search?keyword={content}`

### åœ°å›¾å¯¼èˆªç±»
- **é«˜å¾·åœ°å›¾** - `androidamap://poi?sourceApplication=appname&keywords={content}`
- **ç™¾åº¦åœ°å›¾** - `baidumap://map/place/search?query={content}`

### æ•™è‚²ç±»
- **æœ‰é“è¯å…¸** - `yddict://search?keyword={content}`
- **æ¬§è·¯è¯å…¸** - `eudic://dict/{content}`

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### åŠŸèƒ½æµ‹è¯•
1. **å¤åˆ¶æ–‡æœ¬åˆ°å‰ªè´´æ¿**ï¼šå¦‚"iPhone 15"
2. **å±•å¼€çµåŠ¨å²›**
3. **ç‚¹å‡»åº”ç”¨å›¾æ ‡**ï¼šå¦‚æ·˜å®å›¾æ ‡
4. **è§‚å¯Ÿç»“æœ**ï¼š
   - æ·˜å®åº”ç”¨æ‰“å¼€
   - æ˜¾ç¤º"iPhone 15"çš„æœç´¢ç»“æœ
   - Toastæç¤º"å·²åœ¨æ·˜å®ä¸­æœç´¢: iPhone 15..."

### æ—¥å¿—ç›‘æ§
```bash
adb logcat -s DynamicIslandService | findstr /C:"åº”ç”¨å›¾æ ‡ç‚¹å‡»" /C:"è‡ªåŠ¨ç²˜è´´" /C:"æ„å»ºURL Scheme"
```

é¢„æœŸæ—¥å¿—ï¼š
```
ğŸ¯ åº”ç”¨å›¾æ ‡ç‚¹å‡»: æ·˜å® - å¼€å§‹è‡ªåŠ¨ç²˜è´´è·å–å‰ªè´´æ¿æ•°æ®...
âœ… [è‡ªåŠ¨ç²˜è´´] æˆåŠŸè·å–å†…å®¹ï¼Œé•¿åº¦: 9
ğŸ”— æ„å»ºURL Schemeæœç´¢: taobao - å†…å®¹: iPhone%2015...
ğŸš€ é€šè¿‡URL Schemeè·³è½¬åˆ°æ·˜å®æœç´¢: taobao://s.taobao.com?q=iPhone%2015
```

## ğŸ“Š æ–¹æ¡ˆä¼˜åŠ¿

### 1. **å®æ—¶æ€§**
- æ¯æ¬¡ç‚¹å‡»éƒ½è·å–æœ€æ–°å‰ªè´´æ¿å†…å®¹
- ä¸ä¾èµ–å±•å¼€æ—¶çš„ç¼“å­˜æ•°æ®
- ç¡®ä¿æœç´¢å†…å®¹çš„å‡†ç¡®æ€§

### 2. **ç”¨æˆ·ä½“éªŒ**
- **æ— æ„Ÿæ“ä½œ**ï¼šç”¨æˆ·çœ‹ä¸åˆ°éšè—çš„è¾“å…¥æ¡†
- **å¿«é€Ÿå“åº”**ï¼šç›´æ¥è·³è½¬åˆ°æœç´¢ç»“æœé¡µé¢
- **å‡†ç¡®æœç´¢**ï¼šä½¿ç”¨æœ€æ–°å¤åˆ¶çš„å†…å®¹

### 3. **æŠ€æœ¯å¯é æ€§**
- **å¤šé‡ä¿éšœ**ï¼šInputConnection + ClipboardManageråŒé‡æ–¹æ¡ˆ
- **èµ„æºç®¡ç†**ï¼šåŠæ—¶æ¸…ç†åˆ›å»ºçš„è§†å›¾
- **å¼‚å¸¸å¤„ç†**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶

### 4. **å…¼å®¹æ€§å¼º**
- é€‚ç”¨äºå„ç§Androidç‰ˆæœ¬
- æ”¯æŒæ‰€æœ‰é…ç½®äº†URL schemeçš„åº”ç”¨
- ç»•è¿‡å‰ªè´´æ¿æƒé™é™åˆ¶

## ğŸ”§ å…³é”®ä»£ç ä½ç½®

### ä¸»è¦ä¿®æ”¹æ–‡ä»¶
- `DynamicIslandService.kt`

### æ ¸å¿ƒæ–¹æ³•
1. `handleAppIconClick()` - åº”ç”¨å›¾æ ‡ç‚¹å‡»å¤„ç†ï¼ˆç¬¬5977-6123è¡Œï¼‰
2. `getClipboardContentByAutoPaste()` - è‡ªåŠ¨ç²˜è´´è·å–å‰ªè´´æ¿ï¼ˆç¬¬6134-6188è¡Œï¼‰
3. `performAutoPasteOperation()` - æ‰§è¡Œè‡ªåŠ¨ç²˜è´´æ“ä½œï¼ˆç¬¬6190-6233è¡Œï¼‰

## ğŸ‰ æ€»ç»“

è¿™ä¸ªæ–°æ–¹æ¡ˆå®Œç¾è§£å†³äº†å‰ªè´´æ¿æ•°æ®å®æ—¶æ€§é—®é¢˜ï¼š
- **æŠ€æœ¯ä¸Š**ï¼šé€šè¿‡è‡ªåŠ¨ç²˜è´´è·å–æœ€æ–°å‰ªè´´æ¿å†…å®¹
- **ä½“éªŒä¸Š**ï¼šä¸€é”®è·³è½¬åˆ°åº”ç”¨æœç´¢ç»“æœé¡µé¢
- **å¯é æ€§**ï¼šå¤šé‡ä¿éšœç¡®ä¿åŠŸèƒ½å¯ç”¨
- **å®ç”¨æ€§**ï¼šçœŸæ­£å®ç°äº†"å¤åˆ¶-ç‚¹å‡»-æœç´¢"çš„æ— ç¼ä½“éªŒ

ç°åœ¨ç”¨æˆ·åªéœ€è¦å¤åˆ¶æƒ³è¦æœç´¢çš„å†…å®¹ï¼Œç„¶åç‚¹å‡»ä»»æ„åº”ç”¨å›¾æ ‡ï¼Œå°±èƒ½ç›´æ¥åœ¨è¯¥åº”ç”¨ä¸­çœ‹åˆ°æœç´¢ç»“æœï¼
