# AI应用自动粘贴功能测试指南

## 功能概述

已成功优化了软件tab输入框到AI应用的文本传递功能，支持以下AI应用的自动化文本传递：

### 支持的AI应用
1. **纳米AI** - 使用自动化粘贴方案
2. **Poe** - 使用自动化粘贴方案  
3. **Manus** - 使用自动化粘贴方案
4. **Grok** - 使用自动化粘贴方案
5. **智谱清言** - 使用自动化粘贴方案
6. **DeepSeek** - 使用自动化粘贴方案

## 技术实现

### 1. 多重包名检测
每个AI应用都配置了多个可能的包名，确保能够正确识别已安装的应用：

**DeepSeek包名：**
- `com.deepseek.chat` (主要包名)
- `com.deepseek.ai`
- `ai.deepseek.chat`
- `com.deepseek.mobile`

**智谱清言包名：**
- `com.zhipuai.qingyan` (主要包名)
- `com.zhipuai.chat`
- `cn.zhipuai.qingyan`
- `com.zhipuai.mobile`
- `com.zhipuai.app`

**Manus包名：**
- `tech.butterfly.app` (主要包名)
- `com.manus.im.app`
- `com.manus.search`
- `com.manus.app`
- `com.manus.ai`
- `com.manus.openai`
- `com.manus.mobile`
- `com.manus.butterfly`

**纳米AI包名：**
- `com.qihoo.namiso` (主要包名)
- `com.qihoo.nanoai`
- `com.360.nanoai`
- `com.nanoai.app`
- `com.nano.ai`
- `com.nanoai.mobile`
- `com.nanoai.android`
- `com.nanoai.chat`

### 2. 增强的自动粘贴机制
无障碍服务现在支持多种输入框检测方法：

1. **EditText检测** - 查找标准的EditText输入框
2. **可编辑节点检测** - 查找所有可编辑的UI节点
3. **关键词检测** - 通过"输入"、"问题"、"消息"等关键词查找输入框
4. **ContentDescription检测** - 通过描述信息查找输入框

### 3. 智能重试机制
- 自动检测当前应用是否为目标AI应用
- 支持多次重试，确保应用完全加载后再执行粘贴
- 完善的错误处理和回退机制

## 测试步骤

### 1. 基础功能测试

#### 1.1 测试DeepSeek
1. 打开软件tab
2. 切换到AI分类
3. 在输入框中输入问题（如："你好，请介绍一下自己"）
4. 点击DeepSeek图标
5. 验证DeepSeek是否启动并自动接收问题

#### 1.2 测试智谱清言
1. 在输入框中输入问题（如："请解释一下人工智能的发展历程"）
2. 点击智谱清言图标
3. 验证智谱清言是否启动并自动接收问题

#### 1.3 测试Manus
1. 在输入框中输入问题（如："帮我写一篇关于环保的文章"）
2. 点击Manus图标
3. 验证Manus是否启动并自动接收问题

#### 1.4 测试纳米AI
1. 在输入框中输入问题（如："请推荐几本好书"）
2. 点击纳米AI图标
3. 验证纳米AI是否启动并自动接收问题

#### 1.5 测试Poe
1. 在输入框中输入问题（如："请帮我翻译这段英文"）
2. 点击Poe图标
3. 验证Poe是否启动并自动接收问题

#### 1.6 测试Grok
1. 在输入框中输入问题（如："今天有什么新闻"）
2. 点击Grok图标
3. 验证Grok是否启动并自动接收问题

### 2. 边界情况测试

#### 2.1 空输入测试
1. 清空输入框
2. 点击任意AI应用图标
3. 验证应用是否正常启动（不传递空文本）

#### 2.2 长文本测试
1. 输入很长的文本（超过1000字符）
2. 点击AI应用图标
3. 验证长文本是否能够正确传递

#### 2.3 特殊字符测试
1. 输入包含特殊字符的文本（如：@#$%^&*()）
2. 点击AI应用图标
3. 验证特殊字符是否能够正确传递

### 3. 错误处理测试

#### 3.1 应用未安装测试
1. 卸载某个AI应用
2. 尝试点击该应用图标
3. 验证是否显示安装提示

#### 3.2 无障碍服务未启用测试
1. 关闭无障碍服务
2. 尝试使用自动粘贴功能
3. 验证是否回退到剪贴板方案

#### 3.3 网络问题测试
1. 断开网络连接
2. 尝试启动AI应用
3. 验证应用是否能够正常启动

## 预期结果

### 成功情况
- AI应用能够正常启动
- 输入框中的文本能够自动传递到AI应用
- 用户无需手动复制粘贴
- 显示相应的提示信息

### 失败情况处理
- 如果自动粘贴失败，系统会自动回退到剪贴板方案
- 显示友好的错误提示
- 不会导致应用崩溃

## 日志监控

在测试过程中，可以通过以下日志标签监控功能状态：

- `APP_DETECTION` - 应用检测日志
- `AUTO_PASTE` - 自动粘贴日志
- `ACCESSIBILITY` - 无障碍服务日志

## 注意事项

1. 确保无障碍服务已启用
2. 确保目标AI应用已安装
3. 测试时注意观察日志输出
4. 如果遇到问题，可以尝试重启应用或重新启用无障碍服务

## 故障排除

### 常见问题
1. **自动粘贴不工作** - 检查无障碍服务是否启用
2. **应用无法启动** - 检查应用是否已安装
3. **文本传递失败** - 检查输入框是否可编辑

### 解决方案
1. 重新启用无障碍服务
2. 重新安装目标AI应用
3. 检查应用权限设置
4. 重启设备（如果问题持续存在）