# 小组件功能测试指南

## 🧪 测试步骤

### 1. 编译和安装应用
```bash
# 编译应用
./gradlew assembleDebug

# 安装到设备
adb install app/build/outputs/apk/debug/app-debug.apk
```

### 2. 添加小组件到桌面

#### 方法一：通过桌面长按
1. 长按桌面空白区域
2. 选择"小组件"或"添加小组件"
3. 找到"AI悬浮球"应用
4. 选择"AI悬浮球搜索助手"
5. 拖拽到桌面合适位置

#### 方法二：通过应用抽屉
1. 打开应用抽屉
2. 长按"AI悬浮球"应用图标
3. 选择"小组件"
4. 拖拽到桌面

### 3. 功能测试

#### 测试AI对话功能
1. 点击小组件上的"AI对话"按钮
2. 应该自动启动ChatActivity
3. 自动发送"你好"消息
4. 验证AI回复功能

#### 测试应用搜索功能
1. 点击小组件上的"应用搜索"按钮
2. 应该启动SimpleModeActivity
3. 自动切换到应用搜索页面
4. 显示默认搜索结果

#### 测试网络搜索功能
1. 点击小组件上的"网络搜索"按钮
2. 应该启动DualFloatingWebViewService
3. 在浮动窗口中显示搜索结果
4. 验证搜索引擎正常工作

#### 测试输入功能
1. 点击小组件顶部的输入提示区域
2. 应该弹出输入对话框
3. 输入自定义搜索内容
4. 选择不同的搜索方式测试

### 4. 兼容性测试

#### 不同厂商测试
- [ ] 小米手机 (MIUI)
- [ ] 华为手机 (EMUI/HarmonyOS)
- [ ] OPPO手机 (ColorOS)
- [ ] vivo手机 (OriginOS)
- [ ] 一加手机 (OxygenOS)
- [ ] 原生Android

#### 不同Android版本测试
- [ ] Android 5.0-6.0
- [ ] Android 7.0-8.0
- [ ] Android 9.0-10.0
- [ ] Android 11.0-12.0
- [ ] Android 13.0+

### 5. 错误排查

#### 查看日志
```bash
# 小组件相关日志
adb logcat | grep "SearchWidgetProvider"

# Activity启动日志
adb logcat | grep "SimpleModeActivity"
adb logcat | grep "ChatActivity"

# 服务启动日志
adb logcat | grep "DualFloatingWebViewService"
```

#### 常见问题检查
1. **小组件不显示**
   - 检查应用是否安装成功
   - 重启桌面应用
   - 检查权限设置

2. **点击无响应**
   - 查看logcat错误信息
   - 检查Intent配置
   - 验证目标Activity存在

3. **样式异常**
   - 检查资源文件是否正确
   - 测试不同主题模式
   - 验证颜色资源定义

## 📊 测试结果记录

### 功能测试结果
| 功能 | 状态 | 备注 |
|------|------|------|
| AI对话 | ⭕ 待测试 | |
| 应用搜索 | ⭕ 待测试 | |
| 网络搜索 | ⭕ 待测试 | |
| 输入功能 | ⭕ 待测试 | |

### 兼容性测试结果
| 设备/系统 | 状态 | 备注 |
|-----------|------|------|
| 小米 MIUI | ⭕ 待测试 | |
| 华为 EMUI | ⭕ 待测试 | |
| OPPO ColorOS | ⭕ 待测试 | |
| vivo OriginOS | ⭕ 待测试 | |

### 性能测试结果
| 指标 | 结果 | 备注 |
|------|------|------|
| 启动速度 | ⭕ 待测试 | |
| 内存占用 | ⭕ 待测试 | |
| 响应时间 | ⭕ 待测试 | |

## 🔧 调试命令

```bash
# 强制更新小组件
adb shell am broadcast -a android.appwidget.action.APPWIDGET_UPDATE

# 清除应用数据
adb shell pm clear com.example.aifloatingball

# 重启桌面
adb shell am force-stop com.android.launcher3
adb shell am start -n com.android.launcher3/.Launcher

# 查看小组件信息
adb shell dumpsys appwidget
```

## ✅ 验收标准

### 基本功能
- [x] 小组件能正常添加到桌面
- [ ] 三个功能按钮都能正常响应
- [ ] 输入功能正常工作
- [ ] 各种跳转功能正确

### 用户体验
- [ ] 界面美观，符合设计规范
- [ ] 响应速度快，无明显延迟
- [ ] 错误处理友好
- [ ] 兼容主流设备

### 稳定性
- [ ] 长时间使用无崩溃
- [ ] 内存占用合理
- [ ] 不影响系统性能
- [ ] 支持系统重启后恢复

## 📝 测试报告模板

```
测试日期：____年__月__日
测试设备：________________
系统版本：________________
应用版本：________________

功能测试：
□ AI对话功能正常
□ 应用搜索功能正常  
□ 网络搜索功能正常
□ 输入功能正常

兼容性测试：
□ 小组件显示正常
□ 点击响应正常
□ 样式适配正常

问题记录：
1. ________________________
2. ________________________
3. ________________________

总体评价：
□ 优秀  □ 良好  □ 一般  □ 需改进

测试人员：________________
```
