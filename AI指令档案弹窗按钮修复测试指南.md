# AI指令档案弹窗按钮修复测试指南

## 修复内容概述
本次修复解决了AI指令档案选择弹窗中按钮显示问题，并添加了新建档案功能：

### 1. 主要修复内容
- **按钮显示问题**：重新设计弹窗布局，确保取消、确认、管理档案按钮始终可见
- **新建档案功能**：添加新建档案按钮，支持快速创建和命名新档案
- **布局优化**：优化滚动区域和按钮区域，提升用户体验

### 2. 技术实现
- 使用ScrollView包装主要内容区域，限制最大高度
- 将按钮区域固定在底部，始终可见
- 添加新建档案对话框，支持输入档案名称
- 创建档案后自动刷新档案选择器

## 测试步骤

### 1. 基础功能测试

#### 1.1 打开档案选择弹窗
1. 启动应用
2. 进入搜索tab
3. 点击输入框右边的AI助手按钮
4. 选择"选择AI指令档案"
5. **预期结果**：
   - 弹窗正常显示
   - 底部按钮区域始终可见
   - 包含：新建档案、管理档案、取消、确认四个按钮

#### 1.2 测试按钮可见性
1. 在档案选择弹窗中
2. 滚动查看档案列表和预设资料编辑区域
3. **预期结果**：
   - 无论内容如何滚动，底部按钮区域始终可见
   - 按钮不会被滚动到屏幕外
   - 按钮区域有适当的背景和阴影效果

### 2. 新建档案功能测试

#### 2.1 创建新档案
1. 在档案选择弹窗中
2. 点击"新建档案"按钮
3. **预期结果**：
   - 弹出新建档案对话框
   - 显示输入框和提示文字
   - 包含"创建"和"取消"按钮

#### 2.2 输入档案名称
1. 在新建档案对话框中
2. 输入档案名称（如"测试档案"）
3. 点击"创建"按钮
4. **预期结果**：
   - 显示"档案「测试档案」创建成功"提示
   - 自动关闭新建档案对话框
   - 重新显示档案选择器
   - 新档案出现在档案列表中
   - 新档案自动被设置为当前活跃档案

#### 2.3 测试空名称处理
1. 在新建档案对话框中
2. 不输入任何内容
3. 点击"创建"按钮
4. **预期结果**：
   - 显示"请输入档案名称"提示
   - 对话框不关闭
   - 可以继续输入

#### 2.4 测试取消创建
1. 在新建档案对话框中
2. 输入档案名称
3. 点击"取消"按钮
4. **预期结果**：
   - 对话框关闭
   - 返回档案选择器
   - 没有创建新档案

### 3. 现有功能测试

#### 3.1 测试取消按钮
1. 在档案选择弹窗中
2. 点击"取消"按钮
3. **预期结果**：
   - 弹窗关闭
   - 返回搜索界面
   - 没有进行任何档案切换

#### 3.2 测试确认按钮
1. 在档案选择弹窗中
2. 选择一个档案
3. 点击"确认"按钮
4. **预期结果**：
   - 弹窗关闭
   - 档案切换成功
   - 显示切换成功提示
   - 生成并插入提示词到输入框

#### 3.3 测试管理档案按钮
1. 在档案选择弹窗中
2. 点击"管理档案"按钮
3. **预期结果**：
   - 弹窗关闭
   - 跳转到档案管理页面
   - 可以创建、编辑、删除档案

### 4. 布局和用户体验测试

#### 4.1 测试滚动体验
1. 在档案选择弹窗中
2. 滚动查看档案列表
3. 滚动查看预设资料编辑区域
4. **预期结果**：
   - 滚动流畅，无卡顿
   - 按钮区域始终固定在底部
   - 内容区域有适当的滚动边界

#### 4.2 测试不同屏幕尺寸
1. 在不同尺寸的设备上测试
2. 横屏和竖屏模式都测试
3. **预期结果**：
   - 弹窗适配不同屏幕尺寸
   - 按钮始终可见且可点击
   - 布局不会出现异常

#### 4.3 测试主题适配
1. 在浅色主题下测试
2. 在深色主题下测试
3. **预期结果**：
   - 按钮区域背景色适配主题
   - 文字颜色清晰可见
   - 整体视觉效果协调

### 5. 错误处理测试

#### 5.1 测试网络异常
1. 断开网络连接
2. 尝试创建新档案
3. **预期结果**：
   - 本地创建功能正常
   - 显示适当的错误提示

#### 5.2 测试存储异常
1. 模拟存储空间不足
2. 尝试创建新档案
3. **预期结果**：
   - 显示存储错误提示
   - 不会导致应用崩溃

## 预期结果总结

### 修复前的问题
- 弹窗内容过多，按钮被滚动到屏幕外
- 用户无法看到退出和保存按钮
- 没有快速创建新档案的功能

### 修复后的改进
- ✅ 按钮区域固定在底部，始终可见
- ✅ 添加新建档案功能，支持快速创建
- ✅ 优化布局结构，提升用户体验
- ✅ 支持档案命名和自动设置
- ✅ 创建后自动刷新档案列表

## 注意事项

1. **数据持久化**：新建的档案会保存到本地存储
2. **档案管理**：可以通过管理档案按钮进行更详细的编辑
3. **主题适配**：按钮区域会根据系统主题自动调整颜色
4. **错误处理**：所有操作都有适当的错误提示和异常处理

## 测试完成标准

- [ ] 所有按钮始终可见且可点击
- [ ] 新建档案功能正常工作
- [ ] 档案创建后正确保存和显示
- [ ] 滚动体验流畅
- [ ] 不同设备和主题下表现正常
- [ ] 错误处理机制完善

通过以上测试，确保AI指令档案弹窗的按钮显示问题和新建档案功能都得到完美解决。

