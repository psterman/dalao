# 搜索tab AI按钮功能测试指南

## 功能概述

在搜索tab的默认输入框右侧添加了一个AI按钮，用户点击后可以弹出AI助手档案选择器，选择档案后会将相关预设资料粘贴到输入框内，方便用户构建自己的prompt。

## 实现内容

### 1. 布局修改
- **文件**: `app/src/main/res/layout/layout_app_search.xml`
- **修改**: 在搜索输入框右侧添加了AI助手按钮
- **按钮ID**: `ai_assistant_button`
- **图标**: `@drawable/ic_ai_assistant`
- **样式**: 48dp圆形按钮，使用主题色

### 2. 功能实现
- **文件**: `app/src/main/java/com/example/aifloatingball/SimpleModeActivity.kt`
- **方法**: `showSearchTabAIProfileSelector()`
- **功能**: 
  - 显示AI助手档案选择对话框
  - 支持档案切换
  - 自动生成并插入提示词到搜索输入框
  - 支持追加模式和替换模式

### 3. 主题适配
- **颜色更新**: AI按钮在主题切换时会自动更新颜色
- **方法**: `updateInputAndButtonColors()`
- **颜色**: 使用主题强调色 `simple_mode_accent_light`

## 测试步骤

### 测试1：AI按钮显示
1. 打开应用，进入简易模式
2. 切换到搜索tab（第二个tab）
3. **预期结果**: 在搜索输入框右侧看到AI助手按钮（机器人图标）

### 测试2：AI按钮点击功能
1. 在搜索tab中点击AI助手按钮
2. **预期结果**: 弹出AI助手档案选择对话框

### 测试3：档案选择功能
1. 点击AI助手按钮
2. 在对话框中选择一个档案
3. 点击确认按钮
4. **预期结果**: 
   - 对话框关闭
   - 搜索输入框中出现生成的提示词
   - 显示"已切换到档案: [档案名] 并生成提示词"的提示

### 测试4：提示词追加功能
1. 在搜索输入框中输入一些文字
2. 点击AI助手按钮
3. 选择一个档案并确认
4. **预期结果**: 新生成的提示词追加到现有文字后面，用换行符分隔

### 测试5：提示词替换功能
1. 清空搜索输入框
2. 点击AI助手按钮
3. 选择一个档案并确认
4. **预期结果**: 搜索输入框中只显示新生成的提示词

### 测试6：主题适配
1. 在设置中切换主题（亮色/暗色）
2. 返回搜索tab
3. **预期结果**: AI按钮颜色随主题变化

### 测试7：无档案情况
1. 确保没有创建任何AI助手档案
2. 点击AI助手按钮
3. **预期结果**: 显示"没有可用的档案，请先在设置中创建档案"的提示

## 验证要点

1. **按钮显示**: AI按钮正确显示在搜索输入框右侧
2. **点击响应**: 点击按钮能正确弹出档案选择对话框
3. **档案选择**: 能正确选择档案并生成提示词
4. **文本插入**: 提示词正确插入到搜索输入框
5. **追加模式**: 有现有文本时能正确追加
6. **替换模式**: 无现有文本时能正确替换
7. **主题适配**: 按钮颜色随主题变化
8. **错误处理**: 无档案时显示友好提示

## 注意事项

- 确保已创建AI助手档案才能测试完整功能
- 档案选择对话框使用现有的`dialog_profile_selector`布局
- 提示词生成使用`settingsManager.generateMasterPrompt()`方法
- 按钮颜色使用主题强调色，确保在不同主题下都清晰可见

