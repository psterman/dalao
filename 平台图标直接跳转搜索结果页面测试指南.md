# 平台图标直接跳转搜索结果页面测试指南

## 优化内容

### 1. 直接跳转到搜索结果页面
- **问题**：之前只是跳转到应用的搜索页面，用户还需要手动输入关键词
- **解决方案**：
  - 修改URL scheme，直接跳转到包含关键词的搜索结果页面
  - 使用与软件tab一致的URL scheme格式，确保跳转逻辑统一
  - 优化Web搜索URL，也直接跳转到搜索结果页面

### 2. 与软件tab一致的URL Scheme格式
- **抖音**：`snssdk1128://search/tabs?keyword=关键词`
- **小红书**：`xhsdiscover://search/result?keyword=关键词`
- **YouTube**：`youtube://results?search_query=关键词`
- **哔哩哔哩**：`bilibili://search?keyword=关键词`
- **快手**：`kwai://search?keyword=关键词`
- **微博**：`sinaweibo://searchall?q=关键词`
- **豆瓣**：`douban:///search?q=关键词`

## 测试步骤

### 1. 应用内搜索结果页面跳转测试
1. **进入简易模式**
   - 打开应用，进入简易模式
   - 选择任意AI助手进行对话

2. **测试抖音搜索结果页面**
   - 发送问题："推荐一些好看的电影"
   - 点击抖音图标
   - 确认直接跳转到抖音的视频搜索结果页面
   - 检查搜索结果是否显示"推荐一些好看的电影"相关视频
   - 确认不需要手动输入搜索关键词

3. **测试小红书搜索结果页面**
   - 发送问题："有什么好用的护肤品推荐"
   - 点击小红书图标
   - 确认直接跳转到小红书的笔记搜索结果页面
   - 检查搜索结果是否显示相关的美妆笔记
   - 确认搜索类型为"note"（笔记）

4. **测试哔哩哔哩搜索结果页面**
   - 发送问题："如何学习编程"
   - 点击哔哩哔哩图标
   - 确认直接跳转到哔哩哔哩的综合搜索结果页面
   - 检查搜索结果是否显示相关的学习视频
   - 确认搜索类型为"all"（综合）

5. **测试YouTube搜索结果页面**
   - 发送问题："推荐一些科技视频"
   - 点击YouTube图标
   - 确认直接跳转到YouTube的搜索结果页面
   - 检查搜索结果是否显示相关的科技视频

6. **测试快手搜索结果页面**
   - 发送问题："推荐一些搞笑视频"
   - 点击快手图标
   - 确认直接跳转到快手的视频搜索结果页面
   - 检查搜索结果是否显示相关的搞笑视频

7. **测试微博搜索结果页面**
   - 发送问题："最新的科技新闻"
   - 点击微博图标
   - 确认直接跳转到微博的综合搜索结果页面
   - 检查搜索结果是否显示相关的微博内容

8. **测试豆瓣搜索结果页面**
   - 发送问题："推荐一些好看的电影"
   - 点击豆瓣图标
   - 确认直接跳转到豆瓣的综合搜索结果页面
   - 检查搜索结果是否显示相关的电影信息

### 2. Web搜索结果页面跳转测试
1. **卸载应用测试**
   - 卸载某个平台应用（如抖音）
   - 发送问题："推荐一些好看的视频"
   - 点击抖音图标
   - 确认自动跳转到抖音Web版搜索结果页面
   - 检查URL是否包含搜索关键词和搜索类型参数

2. **Web搜索URL格式测试**
   - 测试各平台的Web搜索URL格式
   - 确认URL包含正确的搜索参数
   - 检查搜索结果页面是否正确显示

### 3. URL Scheme一致性测试
1. **与软件tab对比测试**
   - 在软件tab中点击相同平台图标
   - 对比AI回复中的平台图标跳转
   - 确认两者使用相同的URL scheme格式

2. **跳转结果一致性测试**
   - 使用相同关键词在软件tab和AI回复中跳转
   - 确认跳转到相同的搜索结果页面
   - 检查搜索结果的显示内容是否一致

### 4. 关键词处理测试
1. **中文关键词测试**
   - 发送包含中文的问题
   - 点击平台图标
   - 确认中文关键词被正确编码
   - 检查搜索结果是否准确

2. **特殊字符测试**
   - 发送包含特殊字符的问题
   - 点击平台图标
   - 确认特殊字符被正确处理
   - 检查搜索结果是否正常

3. **长问题测试**
   - 发送很长的问题
   - 点击平台图标
   - 确认关键词被正确清理和截取
   - 检查搜索结果是否相关

### 5. 错误处理测试
1. **应用未安装测试**
   - 卸载平台应用
   - 点击平台图标
   - 确认自动跳转到Web搜索结果页面
   - 检查备选方案是否正常

2. **URL scheme失败测试**
   - 模拟URL scheme跳转失败
   - 确认自动回退到Web搜索
   - 检查错误处理机制

3. **网络异常测试**
   - 断网情况下点击平台图标
   - 确认显示适当的错误提示
   - 检查应用稳定性

### 6. 用户体验测试
1. **跳转速度测试**
   - 点击平台图标
   - 确认跳转速度合理
   - 检查用户反馈提示

2. **搜索结果准确性测试**
   - 对比AI回复和平台搜索结果
   - 确认两者内容相关
   - 检查用户体验一致性

3. **多平台对比测试**
   - 对同一问题点击不同平台图标
   - 对比各平台的搜索结果
   - 确认搜索关键词一致性

## 预期结果

### 1. 直接跳转搜索结果页面
- ✅ 直接跳转到包含关键词的搜索结果页面
- ✅ 不需要用户手动输入搜索关键词
- ✅ 搜索结果页面正确显示相关内容
- ✅ 搜索类型参数正确设置

### 2. URL Scheme准确性
- ✅ 使用正确的URL scheme格式
- ✅ 包含必要的搜索参数
- ✅ 关键词正确编码
- ✅ 搜索类型参数正确

### 3. 用户体验
- ✅ 跳转速度快
- ✅ 搜索结果准确
- ✅ 错误处理完善
- ✅ 用户反馈及时

## 技术实现

### 1. 应用内搜索结果页面URL（与软件tab一致）
```kotlin
val searchUrl = when (config.packageName) {
    "com.ss.android.ugc.aweme" -> {
        // 抖音：使用与软件tab一致的URL scheme
        "snssdk1128://search/tabs?keyword=${Uri.encode(cleanQuery)}"
    }
    "com.xingin.xhs" -> {
        // 小红书：使用与软件tab一致的URL scheme
        "xhsdiscover://search/result?keyword=${Uri.encode(cleanQuery)}"
    }
    "com.google.android.youtube" -> {
        // YouTube：使用与软件tab一致的URL scheme
        "youtube://results?search_query=${Uri.encode(cleanQuery)}"
    }
    "tv.danmaku.bili" -> {
        // 哔哩哔哩：使用与软件tab一致的URL scheme
        "bilibili://search?keyword=${Uri.encode(cleanQuery)}"
    }
    // 其他平台...
}
```

### 2. Web搜索结果页面URL（与软件tab一致）
```kotlin
val webSearchUrl = when (config.packageName) {
    "com.ss.android.ugc.aweme" -> "https://www.douyin.com/search/${Uri.encode(cleanQuery)}"
    "com.xingin.xhs" -> "https://www.xiaohongshu.com/search_result?keyword=${Uri.encode(cleanQuery)}"
    "com.google.android.youtube" -> "https://www.youtube.com/results?search_query=${Uri.encode(cleanQuery)}"
    "tv.danmaku.bili" -> "https://search.bilibili.com/all?keyword=${Uri.encode(cleanQuery)}"
    // 其他平台...
}
```

### 3. URL Scheme一致性
- **与软件tab统一**：使用相同的URL scheme格式，确保跳转逻辑一致
- **经过验证**：软件tab中的URL scheme已经过测试验证，确保能正确跳转
- **维护性**：统一的URL scheme便于维护和更新

## 注意事项
- 确保URL scheme格式与软件tab保持一致，直接跳转到搜索结果页面
- 使用经过验证的URL scheme格式，确保跳转成功率
- 关键词编码要正确处理中文和特殊字符
- 提供完善的错误处理和备选方案
- 测试各种边界情况和异常场景
- 与软件tab的跳转逻辑保持一致性
